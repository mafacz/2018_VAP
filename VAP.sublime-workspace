{
	"auto_complete":
	{
		"selected_items":
		[
			[
				"varia",
				"variables_of_interest\tstatement"
			],
			[
				"set",
				"set_trace\tfunction"
			],
			[
				"vari",
				"variable"
			],
			[
				"variba",
				"variables_of_interest"
			],
			[
				"a",
				"apH_last\tstatement"
			],
			[
				"tenso",
				"Tensor\tclass"
			],
			[
				"ap",
				"apO2\tstatement"
			],
			[
				"train",
				"train_test_split"
			],
			[
				"nn",
				"nn_output"
			],
			[
				"batch",
				"batch_size"
			],
			[
				"total",
				"total_batch"
			],
			[
				"df",
				"df_data"
			],
			[
				"pati",
				"patientID"
			],
			[
				"pao2",
				"pao2_project_names"
			],
			[
				"vis",
				"vis_data"
			],
			[
				"tes",
				"test_predictions_continous"
			],
			[
				"bef",
				"before_tempetco2"
			],
			[
				"count",
				"count"
			],
			[
				"n",
				"nan"
			],
			[
				"var",
				"variables_of_interest"
			],
			[
				"to",
				"to_hdf"
			],
			[
				"as",
				"astype"
			],
			[
				"pat",
				"patientID"
			],
			[
				"apO2",
				"apO2_norm"
			],
			[
				"rss",
				"rss_total"
			],
			[
				"Pati",
				"PatientID"
			],
			[
				"etc",
				"etCO2_mean"
			],
			[
				"Temp",
				"TempCore_4h"
			],
			[
				"Spo",
				"SpO2_filled"
			],
			[
				"test",
				"test_set"
			],
			[
				"columns",
				"columns"
			],
			[
				"col",
				"columns_of_interest"
			],
			[
				"Patei",
				"PatientID"
			],
			[
				"gen",
				"general_data_file"
			]
		]
	},
	"buffers":
	[
		{
			"contents": "import os\nimport pandas as pd\nimport numpy as np\n\n#settings\nvariables_of_interest = ['2200', '4000', '8290', '8280', '200', '410', '7100', '400', , , '300', '310', '5685', '2010', '2600', '2610', '3845', '2410', '2400', '3110', '3200', '3000',\n\t '320', '7150', '420', '7120', '7110', '7130', '7140', '7150', '430', '3950', '341', '2510','2520','2530', '2910', '2900','3501', '3730']\n\n#enviroment variables\ndata_path = \"/cluster/work/grlab/clinical/Inselspital/DataReleases/01-19-2017/InselSpital/\"\ninput_dir = \"1_hdf5_consent/180704\"\noutput_dir = \"derived_mafacz/VAP\"\ngeneral_data_file = os.path.join(data_path, input_dir, \"generaldata.h5\")\nmon_data_file = os.path.join(data_path, input_dir, \"monvals.h5\")\noutput_data_file = os.path.join(data_path, output_dir, \"monvals_pivot.h5\")\n\n#Read General File for Patient IDs\ndf_gen = pd.read_hdf(general_data_file)\n\n#Loop trough all patients and add them to preprocessed table\nfor patientID in df_gen.PatientID:\n\tprint(patientID)\n\tdf_mon_pat = pd.read_hdf(mon_data_file, where='PatientID==' + str(patientID))\n\tdf_mon_pat = df_mon_pat[df_mon_pat.Value.notnull()]\n\tdf_mon_pat = df_mon_pat[df_mon_pat.VariableID.isin(variables_of_interest)]\n\t#pivot table and change to 1Min interval\n\t#df_mon_pat.Value = df_mon_pat.Value.astype('float64')\n\tdf_mon_pat = df_mon_pat.pivot_table(index='Datetime', columns='VariableID', values='Value') #dupplicate values -> mean\n\tdf_mon_pat = df_mon_pat.resample('1Min').mean()\n\tdf_mon_pat = df_mon_pat.rename(columns={x:str(x) for x in df_mon_pat.columns})\n\t#add PatientID column\n\tdf_mon_pat['PatientID'] = patientID\n\tdf_mon_pat = df_mon_pat.set_index('PatientID', append=True)\n\t#add columns of interest which are missing for this patient with nan as value\n\tmissing_columns = set(variables_of_interest) - set(df_mon_pat.columns)\n\tfor col in missing_columns:\n\t\tdf_mon_pat[col] = np.nan\n\n\tif len(df_mon_pat) > 0:\n\t\tdf_mon_pat.to_hdf(output_data_file, 'pivoted', append=True, complevel=5, complib='blosc:lz4', \n\t\t\tdata_columns=['PatientID', 'VariableID'], format='table')\n\n\t\n\t\n",
			"file": "dataloader_mon_table.py",
			"file_size": 2024,
			"file_write_time": 131842815011350671,
			"settings":
			{
				"buffer_size": 2044,
				"encoding": "UTF-8",
				"line_ending": "Unix"
			}
		},
		{
			"file": "dataloader_lab_table.py",
			"settings":
			{
				"buffer_size": 1720,
				"encoding": "UTF-8",
				"line_ending": "Unix"
			}
		},
		{
			"file": "dataloader_derv_table.py",
			"settings":
			{
				"buffer_size": 1704,
				"line_ending": "Unix"
			}
		},
		{
			"file": "dataloader_observ_table.py",
			"settings":
			{
				"buffer_size": 1849,
				"line_ending": "Unix"
			}
		},
		{
			"file": "dataloader_final_table.py",
			"settings":
			{
				"buffer_size": 8175,
				"line_ending": "Unix"
			}
		}
	],
	"build_system": "Packages/Python/Python.sublime-build",
	"build_system_choices":
	[
		[
			[
				[
					"Packages/Python/Python.sublime-build",
					""
				],
				[
					"Packages/Python/Python.sublime-build",
					"Syntax Check"
				]
			],
			[
				"Packages/Python/Python.sublime-build",
				""
			]
		]
	],
	"build_varint": "",
	"command_palette":
	{
		"height": 0.0,
		"last_filter": "",
		"selected_items":
		[
			[
				"packer",
				"Package Control: Install Package"
			],
			[
				"install",
				"Package Control: Install Package"
			]
		],
		"width": 0.0
	},
	"console":
	{
		"height": 241.0,
		"history":
		[
		]
	},
	"distraction_free":
	{
		"menu_visible": true,
		"show_minimap": false,
		"show_open_files": false,
		"show_tabs": false,
		"side_bar_visible": false,
		"status_bar_visible": false
	},
	"expanded_folders":
	[
		"/home/mafacz/source/VAP"
	],
	"file_history":
	[
		"/home/mafacz/source/VAP/variable_references.py",
		"/home/mafacz/source/VAP/variable_exploration.py",
		"/home/mafacz/source/VAP/dataloader_observ_table.py",
		"/home/mafacz/source/VAP/sync_to_cluster.sh",
		"/home/mafacz/source/VAP/dataloader_derv_table.py",
		"/home/mafacz/source/VAP/dataloader_patient_table_for_vap.py",
		"/home/mafacz/source/VAP/dataloader_lab_table.py",
		"/home/mafacz/source/VAP/dataloader_merge_and_dimreduce.py",
		"/home/mafacz/source/VAP/variable_exploration_temp.py",
		"/home/mafacz/source/OxygenationIndex/dataloader_lab_table.py",
		"/home/mafacz/source/OxygenationIndex/dataloader_final_table.py",
		"/home/mafacz/source/OxygenationIndex/dataloader_derv_table.py",
		"/home/mafacz/source/OxygenationIndex/dataloader_patient_table_for_vap.py",
		"/home/mafacz/source/OxygenationIndex/dataloader_mon_table.py",
		"/home/mafacz/source/OxygenationIndex/dataloader_mimic.py",
		"/home/mafacz/source/OxygenationIndex/oi_model_data_split.py",
		"/home/mafacz/source/OxygenationIndex/oi_model_tf_keras.py",
		"/home/mafacz/source/OxygenationIndex/oi_model_tf.py",
		"/home/mafacz/source/OxygenationIndex/oi_model_forwselection_full_model.py",
		"/home/mafacz/source/OxygenationIndex/dataloader_merge_and_dimreduce.py",
		"/home/mafacz/source/OxygenationIndex/dataloader_observ_table.py",
		"/home/mafacz/.config/sublime-text-3/Packages/Anaconda/Anaconda.sublime-settings",
		"/home/mafacz/.config/sublime-text-3/Packages/User/Anaconda.sublime-settings",
		"/home/mafacz/.config/sublime-text-3/Packages/User/JSON.sublime-settings",
		"/home/mafacz/source/OxygenationIndex/variable_references.py",
		"/home/mafacz/source/OxygenationIndex/oi_model_data_stats.py",
		"/home/mafacz/source/OxygenationIndex/oi_model_validation.ipynb",
		"/home/mafacz/source/OxygenationIndex/sync_to_cluster.sh",
		"/home/mafacz/source/OxygenationIndex/oi_model_training_preprocessing.py",
		"/home/mafacz/source/OxygenationIndex/oi_model_data_prepro.py",
		"/home/mafacz/source/OxygenationIndex/oi_model_pred_basic_model.py",
		"/home/mafacz/source/OxygenationIndex/OxygenationIndex.sublime-project",
		"/home/mafacz/source/OxygenationIndex/Dokumentation/Images_Tiff.zip",
		"/home/mafacz/source/OxygenationIndex/.rsyncignore",
		"/home/mafacz/source/OxygenationIndex/VAP/dataloader_patient_table_for_vap.py",
		"/home/mafacz/source/OxygenationIndex/dataloader_filehelper.py"
	],
	"find":
	{
		"height": 50.0
	},
	"find_in_files":
	{
		"height": 0.0,
		"where_history":
		[
		]
	},
	"find_state":
	{
		"case_sensitive": false,
		"find_history":
		[
			"24000610",
			"256",
			"128",
			"5",
			"64",
			"128",
			"64",
			"python",
			"y_train",
			"X_train",
			"df_merged_pat",
			"df_mon_pat",
			"fig",
			"plt",
			"df_test",
			"np.arange(101)",
			"plt",
			"df_filtered",
			"-30, 1, -5, 1,1,",
			"-25, 1, -2.3, 1",
			"\t\t\t\t\t\t\t& (",
			")]",
			"paO2_norm",
			"df_train.paO2_norm",
			"rss = sum((df_test.paO2_norm - y_pred)**2)/len(df_test)",
			"            variable_list = [df_train.SaO2_norm.values, df_train.apH_last_norm.values, df_train.Temp_norm.values, df_train.aHb_last_norm, df_train.aMetHb_last_norm, df_train.paCO2_last_norm, df_train.aBE_last_norm, df_train.aCOHb_last_norm, df_train.aLac_last_norm, df_train.etCO2_10min_mean_norm, df_train.aHCO3_last_norm, df_train.etCO2_norm]\n            variable_test = [df_test.SaO2_norm.values, df_test.apH_last_norm.values, df_test.Temp_norm.values, df_test.aHb_last_norm, df_test.aMetHb_last_norm, df_test.paCO2_last_norm, df_test.aBE_last_norm, df_test.aCOHb_last_norm, df_test.aLac_last_norm, df_test.etCO2_10min_mean_norm, df_test.aHCO3_last_norm, df_test.etCO2_norm]",
			"paO2",
			"SaO2",
			"var",
			"df_train",
			"CalculateVariableMeanStd",
			"df_data",
			"df_filtered",
			"time_delta",
			"pao2",
			"logicalnot",
			")))",
			" > 0) & (",
			"aHCO3",
			"apH",
			"aSO2",
			"df_filtered",
			"etCO2",
			"erCO2",
			"SpO2_filled",
			"df_level_two",
			"df_data",
			"h",
			"_a",
			"df_level_two",
			"total",
			"df_level_one",
			"df_data",
			"paCO2",
			"SaO2",
			"df_total"
		],
		"highlight": true,
		"in_selection": false,
		"preserve_case": false,
		"regex": false,
		"replace_history":
		[
			"-30, 1, -5, 1,3,",
			"-30, 1, -5, 1",
			"df_merged_pat = df_merged_pat[(",
			"df_train[var.apO2_norm]",
			"ss = sum((df_test[var.apO2_norm] - y_pred)**2)/len(df_test)",
			"            variable_list = [df_train[ToNormalizedName(var.aSO2)].values, df_train[ToNormalizedName(var.apH_last)].values, df_train[ToNormalizedName(var.TempCore_4h)].values, df_train[ToNormalizedName(var.aHb_last)], df_train[ToNormalizedName(var.aMetHb_last)], df_train[ToNormalizedName(var.apCO2_last)], df_train[ToNormalizedName(var.aBE_last)], df_train[ToNormalizedName(var.aCOHb_last)], df_train[ToNormalizedName(var.aLac_last)], df_train[ToNormalizedName(var.aHCO3_last)], df_train[ToNormalizedName(var.etCO2)], df_train[ToNormalizedName(var.etCO2_mean)]]\n            variable_test = [df_test[ToNormalizedName(var.aSO2)].values, df_test[ToNormalizedName(var.apH_last)].values, df_test[ToNormalizedName(var.TempCore_4h)].values, df_test[ToNormalizedName(var.aHb_last)], df_test[ToNormalizedName(var.aMetHb_last)], df_test[ToNormalizedName(var.apCO2_last)], df_test[ToNormalizedName(var.aBE_last)], df_test[ToNormalizedName(var.aCOHb_last)], df_test[ToNormalizedName(var.aLac_last)], df_test[ToNormalizedName(var.aHCO3_last)], df_test[ToNormalizedName(var.etCO2)], df_test[ToNormalizedName(var.etCO2_mean)]]",
			"))",
			".isnull())) & np.logicalnot(",
			"[var",
			"[var."
		],
		"reverse": false,
		"show_context": true,
		"use_buffer2": true,
		"whole_word": false,
		"wrap": true
	},
	"groups":
	[
		{
			"selected": 1,
			"sheets":
			[
				{
					"buffer": 0,
					"file": "dataloader_mon_table.py",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 2044,
						"regions":
						{
						},
						"selection":
						[
							[
								115,
								115
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": ".",
									"selector": "source.python - string - comment - constant.numeric"
								},
								{
									"characters": ".",
									"selector": "source.python - string - constant.numeric"
								}
							],
							"git_gutter_is_enabled": true,
							"syntax": "Packages/Python/Python.sublime-syntax",
							"translate_tabs_to_spaces": false
						},
						"translation.x": 0.0,
						"translation.y": 0.0,
						"zoom_level": 1.0
					},
					"stack_index": 1,
					"type": "text"
				},
				{
					"buffer": 1,
					"file": "dataloader_lab_table.py",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 1720,
						"regions":
						{
						},
						"selection":
						[
							[
								95,
								95
							]
						],
						"settings":
						{
							"git_gutter_is_enabled": true,
							"syntax": "Packages/Python/Python.sublime-syntax",
							"translate_tabs_to_spaces": false
						},
						"translation.x": 0.0,
						"translation.y": 0.0,
						"zoom_level": 1.0
					},
					"stack_index": 0,
					"type": "text"
				},
				{
					"buffer": 2,
					"file": "dataloader_derv_table.py",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 1704,
						"regions":
						{
						},
						"selection":
						[
							[
								528,
								528
							]
						],
						"settings":
						{
							"git_gutter_is_enabled": true,
							"syntax": "Packages/Python/Python.sublime-syntax",
							"translate_tabs_to_spaces": false
						},
						"translation.x": 0.0,
						"translation.y": 0.0,
						"zoom_level": 1.0
					},
					"stack_index": 4,
					"type": "text"
				},
				{
					"buffer": 3,
					"file": "dataloader_observ_table.py",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 1849,
						"regions":
						{
						},
						"selection":
						[
							[
								0,
								0
							]
						],
						"settings":
						{
							"git_gutter_is_enabled": true,
							"syntax": "Packages/Python/Python.sublime-syntax",
							"translate_tabs_to_spaces": false
						},
						"translation.x": 0.0,
						"translation.y": 0.0,
						"zoom_level": 1.0
					},
					"stack_index": 3,
					"type": "text"
				},
				{
					"buffer": 4,
					"file": "dataloader_final_table.py",
					"semi_transient": true,
					"settings":
					{
						"buffer_size": 8175,
						"regions":
						{
						},
						"selection":
						[
							[
								0,
								0
							]
						],
						"settings":
						{
							"git_gutter_is_enabled": true,
							"syntax": "Packages/Python/Python.sublime-syntax",
							"translate_tabs_to_spaces": false
						},
						"translation.x": 0.0,
						"translation.y": 0.0,
						"zoom_level": 1.0
					},
					"stack_index": 2,
					"type": "text"
				}
			]
		}
	],
	"incremental_find":
	{
		"height": 47.2
	},
	"input":
	{
		"height": 63.2
	},
	"layout":
	{
		"cells":
		[
			[
				0,
				0,
				1,
				1
			]
		],
		"cols":
		[
			0.0,
			1.0
		],
		"rows":
		[
			0.0,
			1.0
		]
	},
	"menu_visible": true,
	"output.exec":
	{
		"height": 217.0
	},
	"output.find_results":
	{
		"height": 0.0
	},
	"output.mdpopups":
	{
		"height": 0.0
	},
	"pinned_build_system": "",
	"project": "VAP.sublime-project",
	"replace":
	{
		"height": 90.4
	},
	"save_all_on_build": true,
	"select_file":
	{
		"height": 0.0,
		"last_filter": "",
		"selected_items":
		[
		],
		"width": 0.0
	},
	"select_project":
	{
		"height": 625.0,
		"last_filter": "",
		"selected_items":
		[
			[
				"",
				"~/source/OxygenationIndex/OxygenationIndex.sublime-project"
			]
		],
		"width": 475.0
	},
	"select_symbol":
	{
		"height": 0.0,
		"last_filter": "",
		"selected_items":
		[
		],
		"width": 0.0
	},
	"selected_group": 0,
	"settings":
	{
	},
	"show_minimap": true,
	"show_open_files": false,
	"show_tabs": true,
	"side_bar_visible": true,
	"side_bar_width": 524.0,
	"status_bar_visible": true,
	"template_settings":
	{
	}
}
